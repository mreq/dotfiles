#!/usr/bin/env python3
from i3ipc import Connection
from notify import notification
import subprocess
import argparse

import os, sys
sys.path.append(os.path.expanduser('~/.dotfiles/python/modules'))
import dotfiles

directories = [[f.name, f.path, os.path.getmtime(f.path)] for f in os.scandir(os.path.expanduser('~/work/')) if f.is_dir()]

directories.append(['dotfiles', os.path.expanduser('~/.dotfiles'), os.path.getmtime(os.path.expanduser('~/.dotfiles'))])
directories.append(['invoices', os.path.expanduser('~/Dropbox/invoices'), os.path.getmtime(os.path.expanduser('~/Dropbox/invoices'))])

directories = sorted(directories, key=lambda x: x[2], reverse=True)

result = dotfiles.rofi.dmenu([x[0] for x in directories], color = "yellow")

if result:
    directory = [x for x in directories if x[0] == result][0]
    if directory:
        title = directory[0]
        path = directory[1]
        os.system('touch ' + path)
        subprocess.call('kitty --app-id kitty-nvim --title "nvim - ' + title + '" -- nvim . &', shell=True, cwd=path)
