#!/usr/bin/env python3
import i3ipc
import argparse
import os
import code

parser=argparse.ArgumentParser()

parser.add_argument("executable")

parser.add_argument("-w",
                    "--workspace",
                    help = "Switch [string] workspace.")

parser.add_argument("-a",
                    "--app-id",
                    help="app_id if it's different from command")

parser.add_argument("--window-class",
                    help="window_class if it's different from command")

args = parser.parse_args()

if args.workspace is None:
  os.system("notify-send 'You need to provide a workspace using the -w option.'")
  exit(1)

sway = i3ipc.Connection()

sway.command("workspace " + args.workspace)

if args.executable is None:
  exit(0)

tree = sway.get_tree()
app_id = args.app_id or args.executable
window_class = args.window_class

found = False

for c in tree:
  print(c.app_id, app_id)
  if (app_id and c.app_id is app_id) or (window_class and c.window_class is window_class):
    found = True
    break

if found is False:
  os.system(args.executable + " &")
