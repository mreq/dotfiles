#!/usr/bin/env python3
from i3ipc import Connection
from notify import notification

import os, sys
sys.path.append(os.path.expanduser('~/.dotfiles/python/modules'))
import dotfiles

sway = Connection()

outputs = sway.get_outputs()
output_names = [o.name for o in sway.get_outputs()]

if len(outputs) < 2:
    if outputs[0] and not outputs[0].active:
        sway.command('output ' + outputs[0] + ' enable')
    notification('sway_select_display', message='only one output', app_name='sway')
    exit(1)

options = ['auto'] + output_names

result = dotfiles.rofi.dmenu(options)

if result not in options:
    exit(0)

for output in outputs:
    if output.name == result:
        if not output.active:
            sway.command('output ' + result + ' enable')
    else:
        if output.active:
            sway.command('output ' + result + ' disable')
